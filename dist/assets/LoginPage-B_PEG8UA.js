import{r as o,u as S,a as L,b as M,c as P,j as e,L as f,z as n}from"./index-DL8UUPTA.js";import{M as k,L as D,E as _,a as A}from"./mail-DgkB6TId.js";function U(){var h,x;const[l,p]=o.useState(""),[c,j]=o.useState(""),[i,N]=o.useState(!1),[d,u]=o.useState(!1),{login:g,setGuestMode:v}=S(),{t:s}=L(),m=M(),w=((x=(h=P().state)==null?void 0:h.from)==null?void 0:x.pathname)||"/",b=r=>r.endsWith("@ict.nitech.ac.jp"),y=async r=>{if(r.preventDefault(),!l.trim()||!c.trim()){n.error("メールアドレスとパスワードを入力してください");return}if(!b(l)){n.error("名古屋工業大学のメールアドレス（@ict.nitech.ac.jp）を使用してください");return}u(!0);try{await g(l.trim(),c),n.success("ログインしました"),m("/")}catch(t){console.error("Login error:",t);let a="ログインに失敗しました";t.code==="auth/user-not-found"?a="ユーザーが見つかりません。登録してください。":t.code==="auth/wrong-password"?a="パスワードが正しくありません":t.code==="auth/too-many-requests"?a="ログイン試行回数が多すぎます。しばらく待ってから再試行してください":t.code==="auth/user-disabled"?a="アカウントが無効化されています":t.message==="EMAIL_NOT_VERIFIED"?a="メールアドレスの確認が必要です。確認メールをチェックしてください":t.message==="USER_SUSPENDED"?a="アカウントが一時停止されています":t.message==="USER_DOCUMENT_NOT_FOUND"&&(a="ユーザー情報の取得に失敗しました。再試行してください"),n.error(a)}finally{u(!1)}},E=()=>{v(!0),m(w,{replace:!0})};return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header text-center",children:[e.jsx("h1",{className:"card-title",children:s("auth.welcomeToNitechBoard")}),e.jsx("p",{className:"card-description",children:s("auth.welcomeBack")})]}),e.jsxs("form",{onSubmit:y,className:"card-content space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-foreground",children:s("auth.email")}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{id:"email",type:"email",value:l,onChange:r=>p(r.target.value),placeholder:s("auth.enterEmail"),className:"input pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-foreground",children:s("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{id:"password",type:i?"text":"password",value:c,onChange:r=>j(r.target.value),placeholder:s("auth.enterPassword"),className:"input pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>N(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:i?e.jsx(_,{className:"h-4 w-4"}):e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(f,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:s("auth.forgotPassword")})}),e.jsx("button",{type:"submit",disabled:d,className:"btn btn-primary w-full",children:s(d?"common.loading":"auth.login")})]}),e.jsxs("div",{className:"card-footer flex flex-col gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"または"})})]}),e.jsx("button",{onClick:E,className:"btn btn-outline w-full",children:s("auth.continueAsGuest")}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[s("auth.dontHaveAccount")," ",e.jsx(f,{to:"/register",className:"text-primary hover:underline",children:s("auth.createAccount")})]})]})]})})})}export{U as default};
